
### **CookingAgent 需求文档 (PRD)**

**版本: 1.1**
**日期: 2025年7月8日**

#### 1\. 项目概述

**1.1 项目背景**
本项目旨在利用大型语言模型（LLM）的强大能力，结合现有的高质量、结构化的 `HowToCook` 开源菜谱库，打造一款名为 "CookingAgent" 的智能聊天机器人（ChatBot）。它将作为用户的私人烹饪助理，提供从菜单推荐、购物清单到详细烹饪步骤规划的一站式智能服务。

**1.2 目标用户**

  * 希望根据家庭成员、口味和现有条件快速获得科学配餐建议的家庭主厨。
  * 对烹饪流程不熟悉，需要详细步骤指导和时间管理建议的厨房新手。
  * 追求高效、标准化流程的程序员及技术爱好者。

**1.3 项目目标**

  * **智能化**: 超越关键词搜索，能理解用户模糊、复杂的自然语言需求。
  * **个性化**: 根据用户提供的多维度信息（人数、口味、特殊人群等）提供定制化菜单。
  * **流程化**: 将复杂的厨房工作（多道菜的准备和烹饪）规划为清晰、高效的执行流程。
  * **可扩展性**: 系统能随着 `HowToCook` 仓库内容的增加而自动“学会”新菜。

-----

#### 2\. 核心功能需求

##### 2.1 智能菜单推荐

  * **输入**: 用户通过自然语言描述用餐需求，至少应包含：
      * **就餐人数**: 如“我们家三口人吃”。
      * **口味偏好**: 如“想吃点辣的”、“不要太油腻”。
      * **特殊人群**: 如“有小孩，不能吃辣”、“有孕妇，注意忌口”。
      * **季节/场合**: 如“夏天想吃点凉快的”、“周末家庭聚餐”。
  * **处理**:
      * Agent 能准确从对话中提取上述关键信息。
      * Agent 需参考 `食材相克与禁忌.md`，避免推荐有潜在冲突的食材搭配。
      * Agent 需参考 `如何选择现在吃什么.md` 中的荤素搭配原则进行配餐。
  * **输出**:
      * Agent 以清晰的列表形式推荐一份包含荤、素、汤（可选）的完整菜单。
      * （加分项）为每道推荐的菜品附上一句简短的推荐理由。

##### 2.2 食材与厨具清单生成

  * **触发**: 用户确认推荐的菜单后。
  * **处理**:
      * Agent 遍历菜单中所有菜品，汇总其所需的全部“必备原料和工具”和“计算”部分的原始文本。
  * **输出**: Agent 直接呈现每个菜品在 `.md` 文件中 `## 必备原料和工具` 和 `## 计算` 章节下的原始文本内容，不进行解析和合并。

##### 2.3 烹饪流程规划

  * **触发**: 用户确认菜单后，在生成清单的同时或之后生成。
  * **处理**:
      * Agent 分析菜单中所有菜品的“操作”步骤。
      * 识别可并行处理的任务（如：在炖肉的同时可以洗菜、切菜）。
      * 识别任务的依赖关系（如：制作`葱油拌面`前必须先完成`葱油`）。
      * 优化整体烹饪顺序，以最高效、最省时为目标。
      * **上下文长度管理**: 在规划前，检查所有菜品步骤文本的总长度。若超过预设阈值，则先进行高层级的宏观规划，并提示用户可针对具体菜品获取详细步骤。
  * **输出**: Agent 提供一份有序的、甘特图式的烹饪步骤指南。例如：
    > **总指挥官模式：**
    > 1.  **准备阶段 (0-15分钟)**: 先把所有菜的菜洗好、肉切好。
    > 2.  **并行任务 (15-60分钟)**:
    >       * **任务A (燃气灶1)**: 开始炖`红烧肉`，这个菜比较耗时，先炖上。
    >       * **任务B (电饭煲)**: `米饭`现在可以蒸上了。
    > 3.  **收尾阶段 (60-75分钟)**: 红烧肉快炖好时，开始起锅炒`清炒时蔬`，5分钟就好，保证上桌时是热的。

##### 2.4 交互式对话

  * **需求**:
      * 支持多轮对话，能记忆上下文信息。
      * **更换菜品策略**: 当用户要求更换菜品时（如“不要鱼”），Agent 应使用同类型的菜品（如另一个肉菜）进行替换，并确保新菜品不与菜单中其他菜品重复。
      * **能力边界策略**: 当无法严格满足用户所有条件时，Agent 应尝试放宽部分约束（如时间、口味），并向用户解释后给出新的推荐方案。
      * **菜谱问答策略**: 当用户提问具体菜品问题时（如“糖醋排骨可以不放糖吗？”），Agent 的回答应严格基于 `.md` 文件中的内容，不进行创意发挥。

-----

#### 3\. 技术栈选型

  * **开发语言**: TypeScript
  * **AI 框架**: Vercel AI SDK
  * **终端UI框架**: Ink
  * **LLM 提供商**: 支持 Vercel AI SDK 的主流模型（如 OpenAI GPT系列, Anthropic Claude系列, Google Gemini系列等）
  * **数据源**: `HowToCook` GitHub 仓库的 Markdown 文件。

-----

#### 4\. 非功能性需求

  * **性能**: 用户输入后的首次响应时间应在3秒以内，后续流式输出应流畅。
  * **可用性**: 命令行界面（CLI）的交互指令清晰易懂，输出格式美观、易读。
  * **可维护性**: 代码结构清晰，模块化设计，方便未来功能扩展和维护。
  * **数据同步**: 应有机制定期或手动触发对 `HowToCook` 仓库的同步，以更新菜谱数据库。

-----

#### 5\. UI 要求
CLI 程序，运行的 UI 要求如下：
- 启动后顶部显示欢迎消息
- 中间显示消息历史
- 底部有一个输入框可以输入消息，输入消息后提交消息清空输入框，显示输入的消息在消息历史中
- 消息框下面有一行文字显示错误信息、状态等
